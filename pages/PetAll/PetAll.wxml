<view class="container">
  <!-- È°∂ÈÉ®ÊêúÁ¥¢Ê°Ü -->
  <view class="search-container">
    <view class="search-box">
      <icon type="search" size="24" class="search-icon"></icon>
      <input type="text" placeholder="ËØ∑ËæìÂÖ•ÂÆ†Áâ©ÂìÅÁßçÊêúÁ¥¢" 
             bindinput="onSearchInput" 
             value="{{searchKeyword}}"
             class="search-input"/>
             <button bindtap="searchPets" class="search-btn">ÊêúÁ¥¢</button>
    </view>
  </view>

  <!-- ‰∏ªË¶ÅÂÜÖÂÆπÂå∫ -->
  <view class="main">
    <!-- ÂÆ†Áâ©ÂàóË°® -->
    <view id="petList" class="pet-list" wx:if="{{processedPets && processedPets.length > 0}}">
      <view wx:for="{{processedPets}}" wx:for-item="pet" wx:key="id" class="pet-card-vertical" bindtap="handlePetClick" data-id="{{pet.id}}">
        <view class="pet-image-vertical">
          <image 
            src="{{pet.processedImageUrl}}"
            alt="{{pet.name}}" 
            lazy-load="true"
            data-pet-id="{{pet.id}}"
            mode="aspectFill"
            class="w-full h-full object-cover"
            binderror="handleImageError"
            bindtap="onPetImageTap"
          >
          </image>
        </view>
        <view class="pet-info-vertical">
          <view class="name-status-row">
            <text class="pet-name">{{pet.name}}</text>
            <text class="status {{pet.isAdopt === 'ÂæÖÈ¢ÜÂÖª' ? 'status-adoptable' : 'status-deceased'}}">{{pet.isAdopt}}</text>
          </view>
          <view class="breed-age-gender-row">
            <text class="breed">{{pet.breed}}</text>
            <text class="age">{{pet.age}}Â≤Å</text>
            <text class="gender">{{pet.gender}}</text>
          </view>
          <view class="health-location-row">
            <icon type="success" size="14"></icon> 
            <text class="{{pet.healthStatus === 'ÂÅ•Â∫∑' ? 'health-healthy' : 'health-sick'}}">{{pet.healthStatus}}</text>
            <text class="location">{{"Âú∞Âå∫Ôºö" + pet.location}}</text>
          </view>
                    <view class="description-row">
            <view class="description-vertical">
              {{pet.description}}
            </view>
            <!-- ÁÇπËµûÂäüËÉΩ -->
            <view class="like-section" catchtap="toggleLike" data-target-id="{{pet.id}}">
              <view class="like-icon {{likeStates[pet.id] ? 'liked' : ''}}">
                {{likeStates[pet.id] ? '‚ù§Ô∏è' : 'ü§ç'}}
              </view>
              <view class="like-count">{{likeCounts[pet.id] || 0}}</view>
            </view>
          </view>
          
        </view>
      </view>
    </view>

    <!-- Âä†ËΩΩÊõ¥Â§öÊåâÈíÆÂíåÁä∂ÊÄÅÊèêÁ§∫ -->
    <view class="load-more" wx:if="{{hasMore}}">
      <button bindtap="loadMorePets" disabled="{{loading}}" class="load-btn">
        <loading hidden="{{!loading}}" class="loading-icon"></loading>
        {{loading ? 'Âä†ËΩΩ‰∏≠...' : 'Âä†ËΩΩÊõ¥Â§ö'}}
      </button>
    </view>
    <view class="no-more" wx:if="{{!hasMore && processedPets && processedPets.length > 0}}">
      Â∑≤Âä†ËΩΩÂÖ®ÈÉ®Êï∞ÊçÆ
    </view>
  </view>
</view>